# critical files in thsi directory:
# * MakeFullRaindrop.py is the file used to plot the raindrop charts. 
# * UserToolDayPattern.py is called by MakeFullRaindrop.py

# * ImageTest.py  contains an example on how to call the raindrop chart plot with a finite , explicit set of users. 


# Clustering and Raindrop Plot Guide

### Step 1: Run clustering algorithm on db2

Open terminal, then

`ssh username@db2.nanohub.org`

`cd xufeng-clustering`

If want to run Xufeng's algorithm:
~~~~
python3 main_online_users_TS_analysis.py --SQL_username username_ro --SQL_password abcdefghij --class_probe_range YYYY-MM-DD:YYYY-MM-DD
~~~~

If want to run Mike's algorithm:
~~~~
python3 main_online_users_TS_analysis.py --SQL_username username_ro --SQL_password abcdefghij --class_probe_range YYYY-MM-DD:YYYY-MM-DD --task cost_cluster_analysis
~~~~
### Step 2: Get the cluster file generated by algorithm
Open a new window in terminal, and paste

If using Xufeng's algorithm:
~~~~
scp username@db2.nanohub.org:/home/users/username/xufeng-clustering/temp/xufeng_combined_users_analysis_YYYY_MM_DD-YYYY_MM_DD.csv ~/Desktop
~~~~
If using Mike's algorithm: 
~~~~
scp username@db2.nanohub.org:/home/users/username/xufeng-clustering/output/mike_users_analysis_YYYY_MM_DD-YYYY_MM_DD.csv ~/Desktop
~~~~
The file will be downloaded and saved to your local computer desktop. 

### Step 3: Configure _MakeFullRaindrop.py_

Provide the cluster file (from previous steps), geolocation file,start date and end date as configurations

For example: 

`-c` means cluster file

`-g` means geolocation file, it is in the repository, file name is _users_geoclustered_protocol_5_6_7_on_or_after_2007-01-01.20131231.csv_

enter the file path depends on where you save it on your computer. 

`-s` means start date

`-e` means end date
~~~~
-c
~/Desktop/xufeng_combined_users_analysis_YYYY_MM_DD-YYYY_MM_DD.csv
-g
~/Desktop/users_geoclustered_protocol_5_6_7_on_or_after_2007-01-01.20131231.csv
-s
YYYY-MM-DD
-e
YYYY-MM-DD
~~~~

### Step 4: Run the script

The plot will be saved to the same folder of where you save the cluster file